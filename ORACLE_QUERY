SELECT 
	SUM(TOTAL_WEIGHT_JANUARY) AS JAN, 
	SUM(TOTAL_WEIGHT_FEBRUARY) AS FEB, 
	SUM(TOTAL_WEIGHT_MARCH) AS MAR, 
	SUM(TOTAL_WEIGHT_APRIL) AS APR, 
	SUM(TOTAL_WEIGHT_MAY) AS MAY, 
	SUM(TOTAL_WEIGHT_JUNE) AS JUN , 
	SUM(TOTAL_WEIGHT_JULY) AS JUL , 
	SUM(TOTAL_WEIGHT_AUGUST) AS AUG , 
	SUM(TOTAL_WEIGHT_SEPTEMBER) AS SEP , 
	SUM(TOTAL_WEIGHT_OCTOBER) AS OCT , 
	SUM(TOTAL_WEIGHT_NOVEMBER) AS NOV , 
	SUM(TOTAL_WEIGHT_DECEMBER) AS DEC,
	SUM(COUNT_VEHICLE_JANUARY) AS COUNT_VEHICLE_JAN, 
	SUM(COUNT_VEHICLE_FEBRUARY) AS COUNT_VEHICLE_FEB, 
	SUM(COUNT_VEHICLE_MARCH) AS COUNT_VEHICLE_MAR, 
	SUM(COUNT_VEHICLE_APRIL) AS COUNT_VEHICLE_APR, 
	SUM(COUNT_VEHICLE_MAY) AS COUNT_VEHICLE_MAY, 
	SUM(COUNT_VEHICLE_JUNE) AS COUNT_VEHICLE_JUN , 
	SUM(COUNT_VEHICLE_JULY) AS COUNT_VEHICLE_JUL , 
	SUM(COUNT_VEHICLE_AUGUST) AS COUNT_VEHICLE_AUG , 
	SUM(COUNT_VEHICLE_SEPTEMBER) AS COUNT_VEHICLE_SEP , 
	SUM(COUNT_VEHICLE_OCTOBER) AS COUNT_VEHICLE_OCT , 
	SUM(COUNT_VEHICLE_NOVEMBER) AS COUNT_VEHICLE_NOV , 
	SUM(COUNT_VEHICLE_DECEMBER) AS COUNT_VEHICLE_DEC 	
FROM 
( 
	SELECT 
	(CASE WHEN THE_MONTH = 1 THEN SUM(LOADERCODE) ELSE 0 END) AS TOTAL_WEIGHT_JANUARY , 
	(CASE WHEN THE_MONTH = 2 THEN SUM(LOADERCODE) ELSE 0 END) AS TOTAL_WEIGHT_FEBRUARY ,
	(CASE WHEN THE_MONTH = 3 THEN SUM(LOADERCODE) ELSE 0 END) AS TOTAL_WEIGHT_MARCH ,
	(CASE WHEN THE_MONTH = 4 THEN SUM(LOADERCODE) ELSE 0 END) AS TOTAL_WEIGHT_APRIL ,
	(CASE WHEN THE_MONTH = 5 THEN SUM(LOADERCODE) ELSE 0 END) AS TOTAL_WEIGHT_MAY ,
	(CASE WHEN THE_MONTH = 6 THEN SUM(LOADERCODE) ELSE 0 END) AS TOTAL_WEIGHT_JUNE ,
	(CASE WHEN THE_MONTH = 7 THEN SUM(LOADERCODE) ELSE 0 END) AS TOTAL_WEIGHT_JULY ,
	(CASE WHEN THE_MONTH = 8 THEN SUM(LOADERCODE) ELSE 0 END) AS TOTAL_WEIGHT_AUGUST ,
	(CASE WHEN THE_MONTH = 9 THEN SUM(LOADERCODE) ELSE 0 END) AS TOTAL_WEIGHT_SEPTEMBER ,
	(CASE WHEN THE_MONTH = 10 THEN SUM(LOADERCODE) ELSE 0 END) AS TOTAL_WEIGHT_OCTOBER ,
	(CASE WHEN THE_MONTH = 11 THEN SUM(LOADERCODE) ELSE 0 END) AS TOTAL_WEIGHT_NOVEMBER ,
	(CASE WHEN THE_MONTH = 12 THEN SUM(LOADERCODE) ELSE 0 END) AS TOTAL_WEIGHT_DECEMBER,
	(CASE WHEN THE_MONTH = 1 THEN COUNT(DISTINCT(VEHICLE)) ELSE 0 END) AS COUNT_VEHICLE_JANUARY , 
	(CASE WHEN THE_MONTH = 2 THEN COUNT(DISTINCT(VEHICLE)) ELSE 0 END) AS COUNT_VEHICLE_FEBRUARY ,
	(CASE WHEN THE_MONTH = 3 THEN COUNT(DISTINCT(VEHICLE)) ELSE 0 END) AS COUNT_VEHICLE_MARCH ,
	(CASE WHEN THE_MONTH = 4 THEN COUNT(DISTINCT(VEHICLE)) ELSE 0 END) AS COUNT_VEHICLE_APRIL ,
	(CASE WHEN THE_MONTH = 5 THEN COUNT(DISTINCT(VEHICLE)) ELSE 0 END) AS COUNT_VEHICLE_MAY ,
	(CASE WHEN THE_MONTH = 6 THEN COUNT(DISTINCT(VEHICLE)) ELSE 0 END) AS COUNT_VEHICLE_JUNE ,
	(CASE WHEN THE_MONTH = 7 THEN COUNT(DISTINCT(VEHICLE)) ELSE 0 END) AS COUNT_VEHICLE_JULY ,
	(CASE WHEN THE_MONTH = 8 THEN COUNT(DISTINCT(VEHICLE)) ELSE 0 END) AS COUNT_VEHICLE_AUGUST ,
	(CASE WHEN THE_MONTH = 9 THEN COUNT(DISTINCT(VEHICLE)) ELSE 0 END) AS COUNT_VEHICLE_SEPTEMBER ,
	(CASE WHEN THE_MONTH = 10 THEN COUNT(DISTINCT(VEHICLE)) ELSE 0 END) AS COUNT_VEHICLE_OCTOBER ,
	(CASE WHEN THE_MONTH = 11 THEN COUNT(DISTINCT(VEHICLE)) ELSE 0 END) AS COUNT_VEHICLE_NOVEMBER ,
	(CASE WHEN THE_MONTH = 12 THEN COUNT(DISTINCT(VEHICLE)) ELSE 0 END) AS COUNT_VEHICLE_DECEMBER 	 
	FROM 
	(
		SELECT EXTRACT(month FROM RECEPTIONDATE) AS THE_MONTH, 
		VEHICLE,  
		LOADERCODE, 
		QUANTITY 
		FROM harvestingreception 
		WHERE SUBSTR(VEHICLE,1,2) = 'PM' 
		AND RECEPTIONDATE >= add_months( TRUNC(SYSDATE), -11 ) 
		AND RECEPTIONDATE <= SYSDATE 
		AND VEHICLE IN (SELECT VEHICLE  FROM vehicleactivity  WHERE SUBSTR(VEHICLECODE,1,2) = 'TG')
	)   
	GROUP BY THE_MONTH
)
















SELECT 
SUM(FIRSTBAR) AS FIRSTBAR,
SUM(SECONDBAR) AS SECONDBAR,
SUM(THIRDBAR) AS THIRDBAR,
SUM(FOURTHBAR) AS FOURTHBAR,
SUM(FIFTHBAR) AS FIFTHBAR
FROM 
(
SELECT 
(CASE WHEN BAR_POSITION = 'FIRST' THEN RESULT ELSE 0 END) AS FIRSTBAR,
(CASE WHEN BAR_POSITION = 'SECOND' THEN RESULT ELSE 0 END) AS SECONDBAR,
(CASE WHEN BAR_POSITION = 'THIRD' THEN RESULT ELSE 0 END) AS THIRDBAR,
(CASE WHEN BAR_POSITION = 'FOURTH' THEN RESULT ELSE 0 END) AS FOURTHBAR,
(CASE WHEN BAR_POSITION = 'FIFTH' THEN RESULT ELSE 0 END) AS FIFTHBAR 
FROM 
    (SELECT 
    SUM(LOADERCODE) / COUNT(DISTINCT VEHICLE) / EXTRACT(day FROM SYSDATE) AS RESULT 
    , 'FIRST' AS BAR_POSITION, 
    EXTRACT(month FROM SYSDATE) AS MONTH_NUMBER,
    EXTRACT(day FROM SYSDATE) AS NUMBER_OF_DAYS
    FROM harvestingreception 
    WHERE EXTRACT(month FROM RECEPTIONDATE) = EXTRACT(month FROM SYSDATE) 
    AND EXTRACT(year FROM RECEPTIONDATE) = EXTRACT(year FROM SYSDATE)  
    AND VEHICLE IN (SELECT VEHICLECODE  FROM vehicleactivity  WHERE SUBSTR(VEHICLECODE,1,2) = 'PM')
    UNION ALL 
    SELECT 
    SUM(LOADERCODE) / COUNT(DISTINCT VEHICLE) / (1+trunc(last_day(add_months(SYSDATE,-1)))-trunc(add_months(SYSDATE,-1),'MM')) AS RESULT
    , 'SECOND' AS BAR_POSITION , 
    EXTRACT(month FROM add_months(SYSDATE,-1)) AS MONTH_NUMBER, 
    1+trunc(last_day(add_months(SYSDATE,-1)))-trunc(add_months(SYSDATE,-1),'MM') AS NUMBER_OF_DAYS 
    FROM harvestingreception 
    WHERE EXTRACT(month FROM RECEPTIONDATE) = EXTRACT(month FROM add_months(SYSDATE,-1)) 
    AND EXTRACT(year FROM RECEPTIONDATE) = EXTRACT(year FROM add_months(SYSDATE,-1))  
    AND VEHICLE IN (SELECT VEHICLECODE  FROM vehicleactivity  WHERE SUBSTR(VEHICLECODE,1,2) = 'PM')
    UNION ALL 
    SELECT 
    SUM(LOADERCODE) / COUNT(DISTINCT VEHICLE) / (1+trunc(last_day(add_months(SYSDATE,-2)))-trunc(add_months(SYSDATE,-2),'MM')) AS RESULT
    , 'THIRD' AS BAR_POSITION , 
    EXTRACT(month FROM add_months(SYSDATE,-2)) AS MONTH_NUMBER, 
    1+trunc(last_day(add_months(SYSDATE,-2)))-trunc(add_months(SYSDATE,-2),'MM') AS NUMBER_OF_DAYS 
    FROM harvestingreception 
    WHERE EXTRACT(month FROM RECEPTIONDATE) = EXTRACT(month FROM add_months(SYSDATE,-2)) 
    AND EXTRACT(year FROM RECEPTIONDATE) = EXTRACT(year FROM add_months(SYSDATE,-2))  
    AND VEHICLE IN (SELECT VEHICLECODE  FROM vehicleactivity  WHERE SUBSTR(VEHICLECODE,1,2) = 'PM')
    UNION ALL
    SELECT 
    SUM(LOADERCODE) / COUNT(DISTINCT VEHICLE) / (1+trunc(last_day(add_months(SYSDATE,-3)))-trunc(add_months(SYSDATE,-3),'MM'))  AS RESULT
    , 'FOURTH' AS BAR_POSITION , 
    EXTRACT(month FROM add_months(SYSDATE,-3)) AS MONTH_NUMBER, 
    1+trunc(last_day(add_months(SYSDATE,-3)))-trunc(add_months(SYSDATE,-3),'MM') AS NUMBER_OF_DAYS 
    FROM harvestingreception 
    WHERE EXTRACT(month FROM RECEPTIONDATE) = EXTRACT(month FROM add_months(SYSDATE,-3)) 
    AND EXTRACT(year FROM RECEPTIONDATE) = EXTRACT(year FROM add_months(SYSDATE,-3))  
    AND VEHICLE IN (SELECT VEHICLECODE  FROM vehicleactivity  WHERE SUBSTR(VEHICLECODE,1,2) = 'PM')
    UNION ALL
    SELECT 
    SUM(LOADERCODE) / COUNT(DISTINCT VEHICLE) / (LAST_DAY(ADD_MONTHS(SYSDATE,-4)) - TO_DATE('2019-01-16', 'yyyy-mm-dd')) AS RESULT
    , 'FIFTH' AS BAR_POSITION , 
    EXTRACT(month FROM add_months(SYSDATE,-4)) AS MONTH_NUMBER, 
    LAST_DAY(ADD_MONTHS(SYSDATE,-4)) - TO_DATE('2019-01-16', 'yyyy-mm-dd') AS NUMBER_OF_DAYS  
    FROM harvestingreception 
    WHERE EXTRACT(month FROM RECEPTIONDATE) <= EXTRACT(month FROM add_months(SYSDATE,-4)) 
    AND EXTRACT(year FROM RECEPTIONDATE) <= EXTRACT(year FROM add_months(SYSDATE,-4))  
    AND VEHICLE IN (SELECT VEHICLECODE  FROM vehicleactivity  WHERE SUBSTR(VEHICLECODE,1,2) = 'PM')
    ) 
)





SELECT 
  (TRUNC(SYSDATE) - TO_DATE('2019-10-01', 'yyyy-mm-dd') ) +1 - 
  ((((TRUNC(SYSDATE,'D'))-(TRUNC(TO_DATE('2019-10-01', 'yyyy-mm-dd'),'D')))/7)*2) -
  (CASE WHEN TO_CHAR(SYSDATE,'DY','nls_date_language=english')='SUN' THEN 1 ELSE 0 END) -
  (CASE WHEN TO_CHAR(TO_DATE('2019-10-01', 'yyyy-mm-dd'),'DY','nls_date_language=english')='SAT' THEN 1 ELSE 0 END) as BusinessDays
FROM dual


SELECT 
  (TRUNC(last_day(add_months(SYSDATE,-1))) - TRUNC(add_months(SYSDATE,-1), 'MM') ) +1 - 
  ((((TRUNC(last_day(add_months(SYSDATE,-1)),'D'))-(TRUNC(add_months(SYSDATE,-1),'MM')))/7)*2) -
  (CASE WHEN TO_CHAR(last_day(add_months(SYSDATE,-1)),'DY','nls_date_language=english')='SUN' THEN 1 ELSE 0 END) -
  (CASE WHEN TO_CHAR(add_months(SYSDATE,-1),'MM','nls_date_language=english')='SAT' THEN 1 ELSE 0 END) as BusinessDays
FROM dual



SELECT 
ROUND(SUM(FIRSTBAR) / 1000,2) AS FIRSTBAR,
ROUND(SUM(SECONDBAR) / 1000,2) AS SECONDBAR,
ROUND(SUM(THIRDBAR) / 1000,2) AS THIRDBAR,
ROUND(SUM(FOURTHBAR) / 1000, 2) AS FOURTHBAR,
ROUND(SUM(FIFTHBAR) / 1000, 2) AS FIFTHBAR ,
SUM(FIRSTBARYEAR) AS FIRSTBARYEAR,
SUM(SECONDBARYEAR) AS SECONDBARYEAR,
SUM(THIRDBARYEAR) AS THIRDBARYEAR,
SUM(FOURTHBARYEAR) AS FOURTHBARYEAR,
SUM(FIFTHBARYEAR) AS FIFTHBARYEAR 
FROM 
(
    SELECT 
    (CASE WHEN BAR_POSITION = 'FIRST' THEN RESULT ELSE 0 END) AS FIRSTBAR,
    (CASE WHEN BAR_POSITION = 'SECOND' THEN RESULT ELSE 0 END) AS SECONDBAR,
    (CASE WHEN BAR_POSITION = 'THIRD' THEN RESULT ELSE 0 END) AS THIRDBAR,
    (CASE WHEN BAR_POSITION = 'FOURTH' THEN RESULT ELSE 0 END) AS FOURTHBAR,
    (CASE WHEN BAR_POSITION = 'FIFTH' THEN RESULT ELSE 0 END) AS FIFTHBAR,
    (CASE WHEN BAR_POSITION = 'FIRST' THEN YEAR_NUMBER ELSE 0 END) AS FIRSTBARYEAR,
    (CASE WHEN BAR_POSITION = 'SECOND' THEN YEAR_NUMBER ELSE 0 END) AS SECONDBARYEAR,
    (CASE WHEN BAR_POSITION = 'THIRD' THEN YEAR_NUMBER ELSE 0 END) AS THIRDBARYEAR,
    (CASE WHEN BAR_POSITION = 'FOURTH' THEN YEAR_NUMBER ELSE 0 END) AS FOURTHBARYEAR,
    (CASE WHEN BAR_POSITION = 'FIFTH' THEN YEAR_NUMBER ELSE 0 END) AS FIFTHBARYEAR    
    FROM 
    (
        SELECT 
        SUM(LOADERCODE) / COUNT(DISTINCT VEHICLE) / EXTRACT(day FROM SYSDATE) AS RESULT 
        , 'FIRST' AS BAR_POSITION, 
        EXTRACT(month FROM SYSDATE) AS MONTH_NUMBER,
        EXTRACT(year FROM SYSDATE) AS YEAR_NUMBER,    
        EXTRACT(day FROM SYSDATE) AS NUMBER_OF_DAYS
        FROM harvestingreception 
        WHERE EXTRACT(month FROM RECEPTIONDATE) = EXTRACT(month FROM SYSDATE) 
        AND EXTRACT(year FROM RECEPTIONDATE) = EXTRACT(year FROM SYSDATE)  
        AND VEHICLE IN (SELECT VEHICLECODE  FROM vehicleactivity  WHERE SUBSTR(VEHICLECODE,1,2) = 'PM')
            UNION ALL 
        SELECT 
        SUM(LOADERCODE) / COUNT(DISTINCT VEHICLE) / (1+trunc(last_day(add_months(SYSDATE,-1)))-trunc(add_months(SYSDATE,-1),'MM')) AS RESULT
        , 'SECOND' AS BAR_POSITION , 
        EXTRACT(month FROM add_months(SYSDATE,-1)) AS MONTH_NUMBER, 
        EXTRACT(year FROM add_months(SYSDATE,-1)) AS YEAR_NUMBER, 
        1+trunc(last_day(add_months(SYSDATE,-1)))-trunc(add_months(SYSDATE,-1),'MM') AS NUMBER_OF_DAYS 
        FROM harvestingreception 
        WHERE EXTRACT(month FROM RECEPTIONDATE) = EXTRACT(month FROM add_months(SYSDATE,-1)) 
        AND EXTRACT(year FROM RECEPTIONDATE) = EXTRACT(year FROM add_months(SYSDATE,-1))  
        AND VEHICLE IN (SELECT VEHICLECODE  FROM vehicleactivity  WHERE SUBSTR(VEHICLECODE,1,2) = 'PM')
            UNION ALL 
        SELECT 
        SUM(LOADERCODE) / COUNT(DISTINCT VEHICLE) / (1+trunc(last_day(add_months(SYSDATE,-2)))-trunc(add_months(SYSDATE,-2),'MM')) AS RESULT
        , 'THIRD' AS BAR_POSITION , 
        EXTRACT(month FROM add_months(SYSDATE,-2)) AS MONTH_NUMBER, 
        EXTRACT(year FROM add_months(SYSDATE,-2)) AS YEAR_NUMBER,     
        1+trunc(last_day(add_months(SYSDATE,-2)))-trunc(add_months(SYSDATE,-2),'MM') AS NUMBER_OF_DAYS 
        FROM harvestingreception 
        WHERE EXTRACT(month FROM RECEPTIONDATE) = EXTRACT(month FROM add_months(SYSDATE,-2)) 
        AND EXTRACT(year FROM RECEPTIONDATE) = EXTRACT(year FROM add_months(SYSDATE,-2))  
        AND VEHICLE IN (SELECT VEHICLECODE  FROM vehicleactivity  WHERE SUBSTR(VEHICLECODE,1,2) = 'PM')
            UNION ALL
        SELECT 
        SUM(LOADERCODE) / COUNT(DISTINCT VEHICLE) / (1+trunc(last_day(add_months(SYSDATE,-3)))-trunc(add_months(SYSDATE,-3),'MM'))  AS RESULT
        , 'FOURTH' AS BAR_POSITION , 
        EXTRACT(month FROM add_months(SYSDATE,-3)) AS MONTH_NUMBER, 
        EXTRACT(year FROM add_months(SYSDATE,-3)) AS YEAR_NUMBER,    
        1+trunc(last_day(add_months(SYSDATE,-3)))-trunc(add_months(SYSDATE,-3),'MM') AS NUMBER_OF_DAYS 
        FROM harvestingreception 
        WHERE EXTRACT(month FROM RECEPTIONDATE) = EXTRACT(month FROM add_months(SYSDATE,-3)) 
        AND EXTRACT(year FROM RECEPTIONDATE) = EXTRACT(year FROM add_months(SYSDATE,-3))  
        AND VEHICLE IN (SELECT VEHICLECODE  FROM vehicleactivity  WHERE SUBSTR(VEHICLECODE,1,2) = 'PM')
            UNION ALL
        SELECT 
        SUM(LOADERCODE) / COUNT(DISTINCT VEHICLE) / (LAST_DAY(ADD_MONTHS(SYSDATE,-4)) - TO_DATE('2019-01-16', 'yyyy-mm-dd')) AS RESULT
        , 'FIFTH' AS BAR_POSITION , 
        EXTRACT(month FROM add_months(SYSDATE,-4)) AS MONTH_NUMBER, 
        EXTRACT(year FROM add_months(SYSDATE,-4)) AS YEAR_NUMBER,    
        LAST_DAY(ADD_MONTHS(SYSDATE,-4)) - TO_DATE('2019-01-16', 'yyyy-mm-dd') AS NUMBER_OF_DAYS  
        FROM harvestingreception 
        WHERE EXTRACT(month FROM RECEPTIONDATE) <= EXTRACT(month FROM add_months(SYSDATE,-4)) 
        AND EXTRACT(year FROM RECEPTIONDATE) <= EXTRACT(year FROM add_months(SYSDATE,-4))  
        AND VEHICLE IN (SELECT VEHICLECODE  FROM vehicleactivity  WHERE SUBSTR(VEHICLECODE,1,2) = 'PM')
    ) 
)

/*
SELECT 
  (TRUNC(last_day(add_months(SYSDATE,-1))) - TRUNC(add_months(SYSDATE,-1), 'MM') ) +1 - 
  ((((TRUNC(last_day(add_months(SYSDATE,-1))))-(TRUNC(add_months(SYSDATE,-1),'MM')))/7)*2) -
  (CASE WHEN TO_CHAR(TRUNC(last_day(add_months(SYSDATE,-1))),'DY','nls_date_language=english')='SUN' THEN 1 ELSE 0 END) -
  (CASE WHEN TO_CHAR(TRUNC(add_months(SYSDATE,-1),'MM'),'DY','nls_date_language=english')='SAT' THEN 1 ELSE 0 END) as BusinessDays
FROM dual

SELECT 
  (TRUNC(last_day(add_months(SYSDATE,-2))) - TRUNC(add_months(SYSDATE,-2), 'MM') ) +1 - 
  ((((TRUNC(last_day(add_months(SYSDATE,-2))))-(TRUNC(add_months(SYSDATE,-2),'MM')))/7)*2) -
  (CASE WHEN TO_CHAR(TRUNC(last_day(add_months(SYSDATE,-2))),'DY','nls_date_language=english')='SUN' THEN 1 ELSE 0 END) -
  (CASE WHEN TO_CHAR(TRUNC(add_months(SYSDATE,-2),'MM'),'DY','nls_date_language=english')='SAT' THEN 1 ELSE 0 END) as BusinessDays
FROM dual
*/




SELECT 
ROUND(SUM(FIRSTBAR) / 1000,2) AS FIRSTBAR,
ROUND(SUM(SECONDBAR) / 1000,2) AS SECONDBAR,
ROUND(SUM(THIRDBAR) / 1000,2) AS THIRDBAR,
ROUND(SUM(FOURTHBAR) / 1000, 2) AS FOURTHBAR,
ROUND(SUM(FIFTHBAR) / 1000, 2) AS FIFTHBAR ,
SUM(FIRSTBARYEAR) AS FIRSTBARYEAR,
SUM(SECONDBARYEAR) AS SECONDBARYEAR,
SUM(THIRDBARYEAR) AS THIRDBARYEAR,
SUM(FOURTHBARYEAR) AS FOURTHBARYEAR,
SUM(FIFTHBARYEAR) AS FIFTHBARYEAR 
FROM 
(
    SELECT 
    (CASE WHEN BAR_POSITION = 'FIRST' THEN RESULT ELSE 0 END) AS FIRSTBAR,
    (CASE WHEN BAR_POSITION = 'SECOND' THEN RESULT ELSE 0 END) AS SECONDBAR,
    (CASE WHEN BAR_POSITION = 'THIRD' THEN RESULT ELSE 0 END) AS THIRDBAR,
    (CASE WHEN BAR_POSITION = 'FOURTH' THEN RESULT ELSE 0 END) AS FOURTHBAR,
    (CASE WHEN BAR_POSITION = 'FIFTH' THEN RESULT ELSE 0 END) AS FIFTHBAR,
    (CASE WHEN BAR_POSITION = 'FIRST' THEN YEAR_NUMBER ELSE 0 END) AS FIRSTBARYEAR,
    (CASE WHEN BAR_POSITION = 'SECOND' THEN YEAR_NUMBER ELSE 0 END) AS SECONDBARYEAR,
    (CASE WHEN BAR_POSITION = 'THIRD' THEN YEAR_NUMBER ELSE 0 END) AS THIRDBARYEAR,
    (CASE WHEN BAR_POSITION = 'FOURTH' THEN YEAR_NUMBER ELSE 0 END) AS FOURTHBARYEAR,
    (CASE WHEN BAR_POSITION = 'FIFTH' THEN YEAR_NUMBER ELSE 0 END) AS FIFTHBARYEAR    
    FROM 
    (
        SELECT 
        SUM(LOADERCODE) / COUNT(DISTINCT VEHICLE) / COUNT( DISTINCT EXTRACT(day FROM RECEPTIONDATE)) AS RESULT 
        , 'FIRST' AS BAR_POSITION, 
        EXTRACT(month FROM SYSDATE) AS MONTH_NUMBER,
        EXTRACT(year FROM SYSDATE) AS YEAR_NUMBER,    
        EXTRACT(day FROM SYSDATE) AS NUMBER_OF_DAYS
        FROM harvestingreception 
        WHERE EXTRACT(month FROM RECEPTIONDATE) = EXTRACT(month FROM SYSDATE) 
        AND EXTRACT(year FROM RECEPTIONDATE) = EXTRACT(year FROM SYSDATE)  
        AND VEHICLE IN (SELECT VEHICLECODE  FROM vehicleactivity  WHERE SUBSTR(VEHICLECODE,1,2) = 'PM')
            UNION ALL 
        SELECT 
        SUM(LOADERCODE) / COUNT(DISTINCT VEHICLE) / COUNT( DISTINCT EXTRACT(day FROM RECEPTIONDATE) ) AS RESULT
        , 'SECOND' AS BAR_POSITION , 
        EXTRACT(month FROM add_months(SYSDATE,-1)) AS MONTH_NUMBER, 
        EXTRACT(year FROM add_months(SYSDATE,-1)) AS YEAR_NUMBER, 
        1+trunc(last_day(add_months(SYSDATE,-1)))-trunc(add_months(SYSDATE,-1),'MM') AS NUMBER_OF_DAYS 
        FROM harvestingreception 
        WHERE EXTRACT(month FROM RECEPTIONDATE) = EXTRACT(month FROM add_months(SYSDATE,-1)) 
        AND EXTRACT(year FROM RECEPTIONDATE) = EXTRACT(year FROM add_months(SYSDATE,-1))  
        AND VEHICLE IN (SELECT VEHICLECODE  FROM vehicleactivity  WHERE SUBSTR(VEHICLECODE,1,2) = 'PM')
            UNION ALL 
        SELECT 
        SUM(LOADERCODE) / COUNT(DISTINCT VEHICLE) / COUNT( DISTINCT EXTRACT(day FROM RECEPTIONDATE)) AS RESULT
        , 'THIRD' AS BAR_POSITION , 
        EXTRACT(month FROM add_months(SYSDATE,-2)) AS MONTH_NUMBER, 
        EXTRACT(year FROM add_months(SYSDATE,-2)) AS YEAR_NUMBER,     
        1+trunc(last_day(add_months(SYSDATE,-2)))-trunc(add_months(SYSDATE,-2),'MM') AS NUMBER_OF_DAYS 
        FROM harvestingreception 
        WHERE EXTRACT(month FROM RECEPTIONDATE) = EXTRACT(month FROM add_months(SYSDATE,-2)) 
        AND EXTRACT(year FROM RECEPTIONDATE) = EXTRACT(year FROM add_months(SYSDATE,-2))  
        AND VEHICLE IN (SELECT VEHICLECODE  FROM vehicleactivity  WHERE SUBSTR(VEHICLECODE,1,2) = 'PM')
            UNION ALL
        SELECT 
        SUM(LOADERCODE) / COUNT(DISTINCT VEHICLE) / COUNT( DISTINCT EXTRACT(day FROM RECEPTIONDATE))  AS RESULT
        , 'FOURTH' AS BAR_POSITION , 
        EXTRACT(month FROM add_months(SYSDATE,-3)) AS MONTH_NUMBER, 
        EXTRACT(year FROM add_months(SYSDATE,-3)) AS YEAR_NUMBER,    
        1+trunc(last_day(add_months(SYSDATE,-3)))-trunc(add_months(SYSDATE,-3),'MM') AS NUMBER_OF_DAYS 
        FROM harvestingreception 
        WHERE EXTRACT(month FROM RECEPTIONDATE) = EXTRACT(month FROM add_months(SYSDATE,-3)) 
        AND EXTRACT(year FROM RECEPTIONDATE) = EXTRACT(year FROM add_months(SYSDATE,-3))  
        AND VEHICLE IN (SELECT VEHICLECODE  FROM vehicleactivity  WHERE SUBSTR(VEHICLECODE,1,2) = 'PM')
            UNION ALL
        SELECT 
        SUM(LOADERCODE) / COUNT(DISTINCT VEHICLE) / COUNT( DISTINCT EXTRACT(day FROM RECEPTIONDATE)) AS RESULT
        , 'FIFTH' AS BAR_POSITION , 
        EXTRACT(month FROM add_months(SYSDATE,-4)) AS MONTH_NUMBER, 
        EXTRACT(year FROM add_months(SYSDATE,-4)) AS YEAR_NUMBER,    
        LAST_DAY(ADD_MONTHS(SYSDATE,-4)) - TO_DATE('2019-01-16', 'yyyy-mm-dd') AS NUMBER_OF_DAYS  
        FROM harvestingreception 
        WHERE EXTRACT(month FROM RECEPTIONDATE) <= EXTRACT(month FROM add_months(SYSDATE,-4)) 
        AND EXTRACT(year FROM RECEPTIONDATE) <= EXTRACT(year FROM add_months(SYSDATE,-4))  
        AND VEHICLE IN (SELECT VEHICLECODE  FROM vehicleactivity  WHERE SUBSTR(VEHICLECODE,1,2) = 'PM')
    ) 
)










SELECT
EXTRACT(day FROM VEHDATE) AS DAY,  
ROUND(SUM(OUTPUT) / SUM(QUANTITY) / COUNT(DISTINCT VEHICLECODE) / COUNT( DISTINCT EXTRACT(day FROM VEHDATE)) / 1000 , 2) AS AVG_OUTPUT, 
ROUND(SUM(AMOUNT) / SUM(QUANTITY) / COUNT(DISTINCT VEHICLECODE) / COUNT( DISTINCT EXTRACT(day FROM VEHDATE)) / 1000, 2) AS AVG_AMOUNT,
ROUND(SUM(OUTPUT) / COUNT(DISTINCT VEHICLECODE) / COUNT( DISTINCT EXTRACT(day FROM VEHDATE)) / 1000 , 2) AS AVG_OUTPUT_WITH_QTY, 
ROUND(SUM(AMOUNT) / COUNT(DISTINCT VEHICLECODE) / COUNT( DISTINCT EXTRACT(day FROM VEHDATE)) / 1000, 2) AS AVG_AMOUNT_WITH_QTY 
FROM vehicleactivity  
WHERE SUBSTR(VEHICLECODE,1,2) = 'TG'
AND VEHDATE >= TO_DATE('2019-08-01', 'yyyy-mm-dd')
AND VEHDATE <= TO_DATE('2019-08-31', 'yyyy-mm-dd')
AND REFERENCE LIKE '%TBS%'
GROUP BY EXTRACT(day FROM VEHDATE);

SELECT * FROM vehicleactivity  WHERE SUBSTR(VEHICLECODE,1,2) = 'TG'
AND VEHDATE >= TO_DATE('2019-08-01', 'yyyy-mm-dd')
AND VEHDATE <= TO_DATE('2019-08-31', 'yyyy-mm-dd');











SELECT
EXTRACT(day FROM VEHDATE) AS DAY, 
ROUND(SUM(OUTPUT)/SUM(QUANTITY)/1000,2) AS RESULT      
FROM vehicleactivity  
WHERE SUBSTR(VEHICLECODE,1,2) = 'TG'
AND VEHDATE >= TO_DATE('2019-08-01', 'yyyy-mm-dd')
AND VEHDATE <= TO_DATE('2019-08-31', 'yyyy-mm-dd')
AND LOCATIONTYPE = 'FF' AND JOBCODE = '4120002'
GROUP BY EXTRACT(day FROM VEHDATE) ORDER BY EXTRACT(day FROM VEHDATE) 




SELECT ROUND(SUM(TotalPM / 100),2) AS TOTAL, 
ROUND(SUM(TotalTG / 100),2) AS TOTALTG, day AS NAME  
FROM (
SELECT (CASE WHEN TotalCategory = 'PM' THEN RESULT ELSE 0 END) AS TotalPM,  
(CASE WHEN TotalCategory = 'TG' THEN RESULT ELSE 0 END) AS TotalTG, day  
FROM  
    ( 
    SELECT  (SUM(LOADERCODE) / COUNT(VEHICLE) / COUNT(DISTINCT CHITNO)) AS RESULT,  
    'PM' AS TotalCategory, EXTRACT(day FROM RECEPTIONDATE) AS day
     FROM harvestingreception  
    WHERE VEHICLE IN (SELECT VEHICLECODE FROM vehicleactivity WHERE SUBSTR(VEHICLECODE,1,2) = 'PM') 
    AND EXTRACT(month FROM RECEPTIONDATE) = '8'  
    AND EXTRACT(year FROM RECEPTIONDATE) = '2019'  
    GROUP BY EXTRACT(year FROM RECEPTIONDATE), EXTRACT(month FROM RECEPTIONDATE), EXTRACT(day FROM RECEPTIONDATE)  
    UNION ALL  

    SELECT (SUM(OUTPUT) / SUM(VEHICLECOUNTER) / SUM(TRIPCOUNTER) ) AS RESULT,  
    'TG' AS TotalCategory ,  EXTRACT(day FROM VEHDATE) AS day FROM 
    (
        SELECT SUM(OUTPUT) AS OUTPUT, COUNT(VEHICLECODE) AS VEHICLECOUNTER, 
        COUNT(DISTINCT TIME) AS TRIPCOUNTER, VEHDATE 
        FROM vehicleactivity  
        WHERE SUBSTR(VEHICLECODE, 1, 2) = 'TG'  AND EXTRACT(month FROM VEHDATE) = '8'  
        AND EXTRACT(year FROM VEHDATE) = '2019'  
        AND REFERENCE LIKE '%TBS%' 
        GROUP BY VEHICLECODE, VEHDATE ORDER BY VEHICLECODE, VEHDATE    
    )   
    GROUP BY EXTRACT(year FROM VEHDATE), 
    EXTRACT(month FROM VEHDATE), EXTRACT(day FROM VEHDATE) 
    ) 
) 
GROUP BY day ORDER BY NAME ASC 





-------------------------------------------------------------------------------------------
-- SELECT * FROM vehicleactivity WHERE VEHICLECODE LIKE 'TG%' AND to_char(VEHDATE, 'mm.yyyy') = '08.2019' ORDER BY VEHDATE ASC ;
-- SELECT * FROM harvestingreception WHERE VEHICLE LIKE '%PM%' AND to_char(RECEPTIONDATE, 'mm.yyyy') = '08.2019' ORDER BY RECEPTIONDATE ASC;

-- SELECT * FROM costbook WHERE TO_CHAR(TDATE, 'DD.MM.YYYY') = '01.08.2019';

-- SELECT * FROM BUDGETFACTORTABLE;

/*
CREATE TABLE BUDGETBIN (
    ID NUMBER(8) NOT NULL, 
    MENUGROUP VARCHAR(128), 
    TARGET DECIMAL(16,2),     
    UOM VARCHAR(128) 
);

ALTER TABLE BUDGETBIN ADD (CONSTRAINT dept_pk PRIMARY KEY (ID));

-- ALTER TABLE BUDGETBIN ADD TARGETEARLIER2 NUMBER NULL;
-- ALTER TABLE BUDGETBIN SET UNUNSED (TARGETEARLIER, TARGETEARLIER2);
-- ALTER TABLE BUDGETBIN DROP COLUMN TARGETEARLIER2;
CREATE SEQUENCE dept_seq START WITH 1;

SELECT * FROM BUDGETBIN;
*/

-- UPDATE BUDGETBIN  SET TARGET = 8 WHERE MENUGROUP = 'MONTHLYPMTONPERHM'; SELECT * FROM BUDGETBIN;
-- UPDATE BUDGETBIN  SET UOM = 'TON/UNIT' WHERE MENUGROUP = 'MONTHLYTG';
-- UPDATE BUDGETBIN  SET UOM = 'TON/HM' WHERE MENUGROUP = 'MONTHLYPMTONPERHM';

-- INSERT INTO BUDGETBIN VALUES (1, 'MONTHLYPM', 90.00, 'TON/UNIT/DAY', NULL, NULL);
-- INSERT INTO BUDGETBIN VALUES (2, 'MONTHLYTG', 40.00, 'TON/UNIT', NULL, NULL);
-- INSERT INTO BUDGETBIN VALUES (3, 'MONTHLYTGTONPERHM', 6.00, 'TON/UNIT/DAY', 5.5, NULL);
-- INSERT INTO BUDGETBIN VALUES (4, 'MONTHLYPMTONPERHM', 5, 'TON/UNIT/DAY', NULL, NULL);
-- INSERT INTO BUDGETBIN VALUES (5, 'MONTHLYPMTONPERTRIP', 6, 'TON/TRIP', NULL, NULL);
-- INSERT INTO BUDGETBIN VALUES (6, 'MONTHLYTGTONPERTRIP', 2, 'TON/TRIP', NULL, NULL);
-- INSERT INTO BUDGETBIN VALUES (7, 'MONTHLYPMTRIPPERUNIT', 8, 'TRIP/UNIT/DAY', NULL, NULL);
-- INSERT INTO BUDGETBIN VALUES (8, 'MONTHLYTGTRIPPERUNIT', 23, 'TRIP/UNIT/DAY', NULL, NULL);
-- INSERT INTO BUDGETBIN VALUES (9, 'MONTHLYTGHMPERUNIT', 9.5, 'HM/UNIT/DAY', NULL, NULL);
-- INSERT INTO BUDGETBIN VALUES (10, 'MONTHLYPMHMPERUNIT', 12.5, 'HM/UNIT/DAY', NULL, NULL);
-- INSERT INTO BUDGETBIN VALUES (11, 'MONTHLYTGHMPERUNIT_1', NULL, 'HM/UNIT/DAY', NULL, NULL);
-- INSERT INTO BUDGETBIN VALUES (12, 'MONTHLYTGLPERHM', 1.6, 'HM/UNIT/DAY', NULL, NULL);
-- INSERT INTO BUDGETBIN VALUES (13, 'MONTHLYPMKMPERL', NULL, 'KM/L/UNIT', NULL, NULL);
-- SELECT * FROM BUDGETBIN ORDER BY ID DESC;

-- INSERT INTO BUDGETBIN VALUES (14, 'MONTHLYPM', 104.00, 'TON/UNIT/DAY');

/*
CREATE TABLE BUDGETBIN (
    ID NUMBER(8) NOT NULL, 
    MENUGROUP VARCHAR(128), 
    TARGET DECIMAL(16,2),     
    UOM VARCHAR(128),
    TARGETEARLIER NUMBER NULL,
    TARGETEARLIER2 NUMBER NULL     
);
ALTER TABLE BUDGETBIN ADD (CONSTRAINT dept_pk PRIMARY KEY (ID)); 

-- JANGAN LUPA DI COMMIT !!!
*/